set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g mouse on

# Set prefix
set-option -g prefix C-q
unbind-key C-q
bind-key C-q send-prefix

setw -g mode-keys vi

# Copy and paste like vim
bind P paste-buffer
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-selection
bind-key -T copy-mode-vi r send-keys -X rectangle-toggle

# switch between panels
bind h select-pane -L
bind l select-pane -R
bind k select-pane -U
bind j select-pane -D

# Smart pane switching with awareness of Vim splits.
# See: https://github.com/christoomey/vim-tmux-navigator
is_vim="ps -o state= -o comm= -t '#{pane_tty}' \| grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"

is_fzf="ps -o state= -o comm= -t '#{pane_tty}' \| grep -iqE '^[^TXZ ]+ +(\\S+\\/)?fzf$'"

bind -n C-h run "($is_vim && tmux send-keys C-h) || \ tmux select-pane -L"

bind -n C-j run "($is_vim && tmux send-keys C-j)  || \
                         ($is_fzf && tmux send-keys C-j) || \
                         tmux select-pane -D"

bind -n C-k run "($is_vim && tmux send-keys C-k) || \
                          ($is_fzf && tmux send-keys C-k)  || \
                          tmux select-pane -U"

bind -n C-l run  "($is_vim && tmux send-keys C-l) || \
                          tmux select-pane -R"

# bind-key -n C-\ if-shell "$is_vim" "send-keys C-\\" "select-pane -l"

# Resize panes
bind < resize-pane -L 10
bind > resize-pane -R 10
bind - resize-pane -D 10
bind + resize-pane -U 10

# Shift arrow to switch windows
bind -n S-Down previous-window
bind -n S-Up next-window

# Mouse mode
## set -g mouse on
## bind -n WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'select-pane -t=; copy-mode -e; send-keys -M'"
## bind -n WheelDownPane select-pane -t= \; send-keys -M
## bind -n C-WheelUpPane select-pane -t= \; copy-mode -e \; send-keys -M
## bind -T copy-mode-vi    C-WheelUpPane   send-keys -X halfpage-up
## bind -T copy-mode-vi    C-WheelDownPane send-keys -X halfpage-down
## bind -T copy-mode-emacs C-WheelUpPane   send-keys -X halfpage-up
## bind -T copy-mode-emacs C-WheelDownPane send-keys -X halfpage-down
## 
## # To copy, left click and drag to highlight text in yellow, 
## # once you release left click yellow text will disappear and will automatically be available in clibboard
## # # Use vim keybindings in copy mode
## setw -g mode-keys vi
## # Update default binding of `Enter` to also use copy-pipe
## unbind -T copy-mode-vi Enter
## bind-key -T copy-mode-vi Enter send-keys -X copy-pipe-and-cancel "xclip -selection c"
## bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "xclip -in -selection clipboard"


# Set easier window split keys
bind-key v split-window -h
bind-key s split-window -v

# Color 
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",*256col*:Tc"

# Basic color support setting
set-option -g default-terminal "screen-256color"

# Default bar color
set-option -g status-style bg='#1b1c36',fg='#ecf0c1'

# Active Pane
set -g pane-active-border-style "fg=#5ccc96"

# Inactive Pane
set -g pane-border-style "fg=#686f9a"

# Active window
set-option -g window-status-current-style bg='#686f9a',fg='#ffffff'

# Message
set-option -g message-style bg='#686f9a',fg='#ecf0c1'
set-option -g message-command-style bg='#686f9a',fg='#ecf0c1'

# When Commands are run
set -g message-style "fg=#0f111b,bg=#686f9a"

# Easy config reload
bind-key r source-file ~/.tmux.conf \; display-message "~/.tmux.conf reloaded."

run '~/.tmux/plugins/tpm/tpm'
